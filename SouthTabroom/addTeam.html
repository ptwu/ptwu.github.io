<!DOCTYPE html>
<html lang="en">

  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0"/>
  <meta http-equiv="Content-Security-Policy" content="default-src *; style-src 'self' http://* 'unsafe-inline'; script-src 'self' http://* 'unsafe-inline' 'unsafe-eval'" />
  <title>SouthTabroom | Edit Debaters</title>

  <!-- CSS  -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link href="css/materialize.css" type="text/css" rel="stylesheet" media="screen,projection"/>
    
</head>
<body>
  <header>  
      <nav class="top-nav" style="background-color:#104E36">
      <div class="container">
          <div class="nav-wrapper">
        <a href="#" data-activates="slide-out" class="page-title button-collapse show-on-large"><i class="material-icons">menu</i></a>
        <a href="index.html" class="brand-logo center" style = "font-weight: bold">SouthTabroom</a>
      </nav>

      <ul id="slide-out" class="side-nav" >
      <li><a style="text-color:#000000;pointer-events: none">Menu</a></li>

         <li><a class="waves-effect" href="index.html"><i class="material-icons">home</i>Home</a></li>  
      <li><a class="waves-effect" href="addJudge.html"><i class="material-icons">assignment_ind</i>Add Judges</a></li>  
      <li class = "active"><a class="waves-effect" href="#"><i class="material-icons">group_add</i>Add/Edit Debaters</a></li> 
       <li><a class="waves-effect" href="addRoom.html"><i class="material-icons">add_to_photos</i>Add/Edit Rooms</a></li> 
       <li><a class="waves-effect" href="addRound.html"><i class="material-icons">plus_one</i>Add Completed Round</a></li> 
       <li><a class="waves-effect" href="makeRound.html"><i class="material-icons">add_circle</i>Generate Round</a></li> 
    </ul>
 <main>
  <h4 style="text-align:center">Add Teams</h4>
   <div class="row">
   <div class = "container">
                <form class="col s12">
   <div class="input-field col s6">
  <h6>Member 1 Full Name</h6> <input id="createDebater1_name" type="text" name="name" placeholder="e.g. Joshua Cohen"><br>
  </div>
   <div class="input-field col s6">
  <h6>Member 2 Full Name (leave blank if one man)</h6> <input id="createDebater2_name" type="text" name="lastName" placeholder="e.g. Joseph Myers"><br>
  </div>
  <button id="createButton" type = "button" class="btn-large waves-effect waves-light green darken-3" onclick="tabroom_firebase_addObject()">Add</button>
  </form>
</form>
</div>
  <div class="row center">
        <br>
        
    </div>
    <br><br>
    <h4 style="text-align:center">Team List</h4>
    <!--OBJECT CARD-->
    <div id="maincontainerpage" class="container">
  
  </main>
    </header>

    

  <!--  Scripts-->
  <script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
  <script src="js/materialize.js"></script>

 <script src="https://www.gstatic.com/firebasejs/4.8.0/firebase.js"></script>
  <script>
  document.querySelector("#createDebater2_name").addEventListener("keyup", event => {
    if(event.key !== "Enter") return; // Use `.key` instead.
    document.querySelector("#createButton").click(); // Things you want to do.
    event.preventDefault(); // No need to `return false;`.
});
    var config = {
      apiKey: "AIzaSyAf-Gxwkw2OUcXuAOF9_T9pQZWkHFCLiWI",
      authDomain: "southtabroom.firebaseapp.com",
      databaseURL: "https://southtabroom.firebaseio.com",
      projectId: "southtabroom",
      storageBucket: "",
      messagingSenderId: "1046315294394"
    };
    firebase.initializeApp(config);
  </script>
        <script>
        function tabroom_firebase_getObjects()
        {
            return firebase.database().ref('/teams/').once('value').then(function(snapshot) {
              var json = snapshot.val();
                for(var i in json)
                {
                  if(json[i].teamUID === firebase.auth().currentUser.uid)
                  {
                    var key = json[i].keyValue;
                    var name1 = json[i].name1;
                    var name2 = json[i].name2;
                    var score1 = json[i].debater1Score;
                    var score2 = json[i].debater2Score;
                    var wins = json[i].wins;
                    var losses = json[i].losses;
                    var numDebates = json[i].debates;
                    if (name2 == null || name2 == "" || name2 == "NaN") {
                      document.getElementById("maincontainerpage").innerHTML += "<div class='row valign-wrapper'> <div class='col s12'> <div class='card'>  <span class='card-title'>" + name1 + " (" + score1 +")" + " (Solo) " +"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Team Score: (" + wins + " - " + losses + ")" +  " &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   Number of Debates: " + numDebates + "</span> </div> <div class='card-content'>  </div> <div class='card-action'> <button class='btn waves-effect waves-light green darken-3' onclick='tabroom_firebase_deleteObj(" + key + ")'>Remove Team</button> </div> </div> </div> </div>";
                    } else {
                        document.getElementById("maincontainerpage").innerHTML += "<div class='row valign-wrapper'> <div class='col s12'> <div class='card'>  <span class='card-title'>" + name1 + " (" + score1 + ")" + " and " + name2 + " (" + score2 + ")" + "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Team Score: (" + wins + " - " + losses + ")" + " &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   Number of Debates: " + numDebates + "</span> </div> <div class='card-content'>  </div> <div class='card-action'> <button class='btn waves-effect waves-light green darken-3' onclick='tabroom_firebase_deleteObj(" + key + ")'>Remove Team</button> </div> </div> </div> </div>";
                      }

                  }
                     
                    
                }
              
            });
        }
        firebase.auth().signInAnonymously().catch(function(error) {
  // Handle Errors here.
  var errorCode = error.code;
  var errorMessage = error.message;
  // ...
});
var globalLoggedIn = false;
        firebase.auth().onAuthStateChanged(function(user) {
  if (user) {
     globalLoggedIn = true;
    // User is signed in.
    var isAnonymous = user.isAnonymous;
    var uid = user.uid;
    // ...
  } else {
    // User is signed out.
    // ...
  }
  // ...
});
       tabroom_firebase_getObjects();
  document.addEventListener('deviceready', function() {
          
      });
     
  </script>

  <script>
    function tabroom_firebase_addObject()
        {
          var database = firebase.database();
          var randomNumber = new Date().getUTCMilliseconds();
          var title = document.getElementById("createDebater1_name").value;
          var lastName = document.getElementById("createDebater2_name").value;
          var debater1S = 0;
          var debater2S = 0;
          var teamWins = 0;
          var teamLosses = 0;
          var totalDebates = 0;
      var currentTime = new Date();
 
       firebase.database().ref('teams/' + randomNumber).set({
       teamUID: firebase.auth().currentUser.uid,
       name1: title,
       dateadded: (currentTime.getMonth() + 1) + '/' + currentTime.getDate() + '/' + currentTime.getFullYear(),
       name2: lastName,
       wins: teamWins,
       losses: teamLosses,
       debater1Score: debater1S,
       debater2Score: debater2S,
       keyValue: randomNumber,
       debates: totalDebates
       
       });
document.location = 'addTeam.html';
            
        }
    function tabroom_firebase_deleteObj(objID)
        {
            firebase.database().ref('teams/' + objID).remove();
            document.location = 'addTeam.html';
        }
      
        
  </script>
  <script>
  $(".button-collapse").sideNav();
  
  </script>
  </body>
</html>
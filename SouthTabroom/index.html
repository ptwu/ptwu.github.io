<!DOCTYPE html>
<html lang="en">

  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0"/>
  <meta http-equiv="Content-Security-Policy" content="default-src *; style-src 'self' http://* 'unsafe-inline'; script-src 'self' http://* 'unsafe-inline' 'unsafe-eval'" />
  <title>SouthTabroom</title>

  <!-- CSS  -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link href="css/materialize.css" type="text/css" rel="stylesheet" media="screen,projection"/>
  <link href="css/style.css" type="text/css" rel="stylesheet" media="screen,projection"/>
    
</head>
<body>
  <header>	
      <nav class="top-nav" style="background-color:#104E36"></nav>
 <main>
  <h4 style="text-align:center">Add Judges</h4>
   <div class="row">
                <form class="col s12">
   <div class="input-field col s6">
  <h6>First name</h6> <input id="createJudge_name" type="text" name="name" placeholder="e.g. ShreYuh"><br>
  </div>
   <div class="input-field col s6">
  <h6>Last name</h6> <input id="createJudge_lastName" type="text" name="lastName" placeholder="e.g. SriniTrappin"><br>
  </div>
</form>
</div>
  <div class="row center">
        
        <button  id="createButton" class="btn-large waves-effect waves-light green darken-3" onclick="tabroom_firebase_addObject()">Add</button>
    </div>
    <br><br>
    <h4 style="text-align:center">Judge List</h4>
    <!--OBJECT CARD-->
    <div id="maincontainerpage" class="container">
  
  </main>
     
    </header>
	<main>
		
  </main>
    


  <!--  Scripts-->
  <script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
  <script src="js/materialize.js"></script>
  <script src="js/init.js"></script>

 <script src="https://www.gstatic.com/firebasejs/4.8.0/firebase.js"></script>
  <script>
    var config = {
      apiKey: "AIzaSyAf-Gxwkw2OUcXuAOF9_T9pQZWkHFCLiWI",
      authDomain: "southtabroom.firebaseapp.com",
      databaseURL: "https://southtabroom.firebaseio.com",
      projectId: "southtabroom",
      storageBucket: "",
      messagingSenderId: "1046315294394"
    };
    firebase.initializeApp(config);
  </script>
        <script>
        function tabroom_firebase_getObjects()
        {
            return firebase.database().ref('/objects/').once('value').then(function(snapshot) {
              var json = snapshot.val();
                for(var i in json)
                {
                  if(json[i].creatorUID === firebase.auth().currentUser.uid)
                  {
                    var key = json[i].keyValue;
                    var lastName = json[i].judgeLastName;
                    var creatorName = json[i].creatorName;
                        document.getElementById("maincontainerpage").innerHTML += "<div class='row valign-wrapper'> <div class='col s12'> <div class='card'>  <span class='card-title'>" + creatorName + " " + lastName + "</span> </div> <div class='card-content'>  </div> <div class='card-action'> <button class='btn waves-effect waves-light green darken-3' onclick='tabroom_firebase_deleteObj(" + key + ")'>Remove Judge</button> </div> </div> </div> </div>";

                  }
                     
                    
                }
              
            });
        }
        firebase.auth().signInAnonymously().catch(function(error) {
  // Handle Errors here.
  var errorCode = error.code;
  var errorMessage = error.message;
  // ...
});
var globalLoggedIn = false;
        firebase.auth().onAuthStateChanged(function(user) {
  if (user) {
  	 globalLoggedIn = true;
    // User is signed in.
    var isAnonymous = user.isAnonymous;
    var uid = user.uid;
    // ...
  } else {
    // User is signed out.
    // ...
  }
  // ...
});
       tabroom_firebase_getObjects();
  document.addEventListener('deviceready', function() {
          
      });
     
  </script>

  <script>
    function tabroom_firebase_addObject()
        {
          var database = firebase.database();
          var randomNumber = new Date().getUTCMilliseconds();
          var title = document.getElementById("createJudge_name").value;
          var lastName = document.getElementById("createJudge_lastName").value;
      var currentTime = new Date();
   
       firebase.database().ref('objects/' + randomNumber).set({
       creatorUID: firebase.auth().currentUser.uid,
       creatorName: title,
       dateadded: (currentTime.getMonth() + 1) + '/' + currentTime.getDate() + '/' + currentTime.getFullYear(),
       judgeLastName: lastName,
       keyValue: randomNumber,
       
       });
document.location = 'index.html';
            
        }
    function tabroom_firebase_deleteObj(objID)
        {
            firebase.database().ref('objects/' + objID).remove();
            document.location = 'index.html';
        }
      
        
  </script>
  </body>
</html>
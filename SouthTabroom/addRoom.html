<!DOCTYPE html>
<html lang="en">

  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0"/>
  <meta http-equiv="Content-Security-Policy" content="default-src *; style-src 'self' http://* 'unsafe-inline'; script-src 'self' http://* 'unsafe-inline' 'unsafe-eval'" />
  <title>SouthTabroom | Add Rooms</title>

  <!-- CSS  -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link href="css/materialize.css" type="text/css" rel="stylesheet" media="screen,projection"/>
  <link href="css/style.css" type="text/css" rel="stylesheet" media="screen,projection"/>
    
</head>
<body>
  <header>  
      <nav class="top-nav" style="background-color:#104E36">
      <div class="container">
          <div class="nav-wrapper">
        <a href="#" data-activates="slide-out" class="page-title button-collapse show-on-large"><i class="material-icons">menu</i></a>
        <a href="index.html" class="brand-logo center" style = "font-weight: bold">SouthTabroom</a>
      </nav>

      <ul id="slide-out" class="side-nav" >
      <li><a style="text-color:#000000;pointer-events: none">Menu</a></li>

      <li><a class="waves-effect" href="index.html"><i class="material-icons">home</i>Home</a></li>  
      <li><a class="waves-effect" href="addJudge.html"><i class="material-icons">assignment_ind</i>Add Judges</a></li>  
      <li><a class="waves-effect" href="addTeam.html"><i class="material-icons">group_add</i>Add/Edit Debaters</a></li> 
       <li class = "active"><a class="waves-effect" href="#"><i class="material-icons">add_to_photos</i>Add/Edit Rooms</a></li> 
    </ul>
 <main>
  <h4 style="text-align:center">Add Rooms</h4>
   <div class="row">
   <div class = "container">
                <form class="col s12">
   <div class="input-field col s12">
  <h6>Room #</h6> <input id="createRoom_name" type="text" name="name" placeholder="e.g. 700B"><br>
  </div>

  <button id="createButton" type = "button" class="btn-large waves-effect waves-light green darken-3" onclick="tabroom_firebase_addObject()">Add</button>
  </form>
</form>
</div>
  <div class="row center">
        <br>
        
    </div>
    <br><br>
    <h4 style="text-align:center">Room List</h4>
    <!--OBJECT CARD-->
    <div id="maincontainerpage" class="container">
  
  </main>
    </header>

    

  <!--  Scripts-->
  <script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
  <script src="js/materialize.js"></script>
  <script src="js/init.js"></script>

 <script src="https://www.gstatic.com/firebasejs/4.8.0/firebase.js"></script>
  <script>
  document.querySelector("#createRoom_name").addEventListener("keyup", event => {
    if(event.key !== "Enter") return; // Use `.key` instead.
    document.querySelector("#createButton").click(); // Things you want to do.
    event.preventDefault(); // No need to `return false;`.
});
    var config = {
      apiKey: "AIzaSyAf-Gxwkw2OUcXuAOF9_T9pQZWkHFCLiWI",
      authDomain: "southtabroom.firebaseapp.com",
      databaseURL: "https://southtabroom.firebaseio.com",
      projectId: "southtabroom",
      storageBucket: "",
      messagingSenderId: "1046315294394"
    };
    firebase.initializeApp(config);
  </script>
        <script>
        function tabroom_firebase_getObjects()
        {
            return firebase.database().ref('/rooms/').once('value').then(function(snapshot) {
              var json = snapshot.val();
                for(var i in json)
                {
                  if(json[i].roomUID === firebase.auth().currentUser.uid)
                  {
                    var key = json[i].keyValue;
                    var room = json[i].roomNo;
                        document.getElementById("maincontainerpage").innerHTML += "<div class='row valign-wrapper'> <div class='col s12'> <div class='card'>  <span class='card-title'>" + "Room " + " " + room + "</span> </div> <div class='card-content'>  </div> <div class='card-action'> <button class='btn waves-effect waves-light green darken-3' onclick='tabroom_firebase_deleteObj(" + key + ")'>Remove Room</button> </div> </div> </div> </div>";

                  }
                     
                    
                }
              
            });
        }
        firebase.auth().signInAnonymously().catch(function(error) {
  // Handle Errors here.
  var errorCode = error.code;
  var errorMessage = error.message;
  // ...
});
var globalLoggedIn = false;
        firebase.auth().onAuthStateChanged(function(user) {
  if (user) {
     globalLoggedIn = true;
    // User is signed in.
    var isAnonymous = user.isAnonymous;
    var uid = user.uid;
    // ...
  } else {
    // User is signed out.
    // ...
  }
  // ...
});
       tabroom_firebase_getObjects();
  document.addEventListener('deviceready', function() {
          
      });
     
  </script>

  <script>
    function tabroom_firebase_addObject()
        {
          var database = firebase.database();
          var randomNumber = new Date().getUTCMilliseconds();
          var room = document.getElementById("createRoom_name").value;
          console.log(room);
      var currentTime = new Date();
   
       firebase.database().ref('rooms/' + randomNumber).set({
       roomUID: firebase.auth().currentUser.uid,
       dateadded: (currentTime.getMonth() + 1) + '/' + currentTime.getDate() + '/' + currentTime.getFullYear(),
       roomNo: room,
       keyValue: randomNumber,
       });
document.location = 'addRoom.html';
            
        }
    function tabroom_firebase_deleteObj(objID)
        {
            firebase.database().ref('rooms/' + objID).remove();
            document.location = 'addRoom.html';
        }
      
        
  </script>
  <script>
  $(".button-collapse").sideNav();
  
  </script>
  </body>
</html>